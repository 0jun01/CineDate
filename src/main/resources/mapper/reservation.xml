<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper
	namespace="com.tenco.movie.repository.interfaces.ReservationRepository">

	<select id="findAll"
		resultType="com.tenco.movie.repository.model.MovieDetailTB">
		select * from movie_detail_tb
	</select>

	<select id="findAscMovie"
		resultType="com.tenco.movie.repository.model.MovieDetailTB">
		select * from movie_detail_tb order by title;
	</select>

	<select id="findGradeNmMovie"
		resultType="com.tenco.movie.repository.model.MovieDetailTB">
		SELECT *
		FROM movie_detail_tb
		ORDER BY
		CASE
		WHEN watch_grade_Nm
		= '전체관람가' THEN 1
		WHEN watch_grade_Nm = '12세이상관람가' THEN 2
		WHEN
		watch_grade_Nm = '15세이상관람가' THEN 3
		WHEN watch_grade_Nm = '19세이상관람가'
		THEN 4
		ELSE 5
		END asc;
	</select>

	<select id="findAllRegions"
		resultType="com.tenco.movie.repository.model.Regions">
		select *
		from regions_tb
		order by id asc;
	</select>

	<select id="findSubRegionById"
		resultType="com.tenco.movie.repository.model.SubRegions">
		select * from subregions_tb
		where region_id = #{id}
		order by
		region_id;
	</select>

	<select id="findMovieByFetchedDate"
		resultType="com.tenco.movie.repository.model.MovieDetailTB">
		select distinct(m.movie_id), m.title, m.watch_grade_Nm
		from showtimes as s
		left join movie_detail_tb as m on s.movie_id = m.id
		where show_date = #{date}
	</select>
</mapper>
